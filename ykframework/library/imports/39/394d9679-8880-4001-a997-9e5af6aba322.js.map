{"version":3,"sources":["assets\\YK\\core\\statemechine\\StateMachine.ts"],"names":[],"mappings":";;;;;AAEA;IACI;QAGQ,cAAS,GAAwB,IAAI,GAAG,EAAkB,CAAC;IAFnE,CAAC;IAKD,sBAAW,kCAAQ;aAAnB;YACI,OAAO,IAAI,CAAC,SAAS,CAAC;QAC1B,CAAC;;;OAAA;IAEM,2BAAI,GAAX;QACI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,EAAE;YACvB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YACjC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACxB;IACL,CAAC;IAEM,oCAAa,GAApB,UAAqB,KAAa;QAC9B,IAAI,KAAK,IAAI,IAAI;YAAE,OAAO;QAC1B,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC;YAAE,OAAO;QAC9C,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAA;IAE5C,CAAC;IAEM,kCAAW,GAAlB,UAAmB,OAAe;QAC9B,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC;YAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAChE,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,IAAI,OAAO,EAAE;YAC3D,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAC5B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;SACxB;IAEL,CAAC;IAEM,kCAAW,GAAlB,UAAmB,OAAe,EAAE,KAAU;QAC1C,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,IAAI,OAAO;YAAE,OAAO;QACtE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;YAC9B,OAAO,CAAC,KAAK,CAAC,oBAAoB,GAAG,OAAO,CAAC,CAAC;YAC9C,OAAM;SACT;QACD,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAC5C,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI;YACrB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;QAC3C,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QACxE,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;IAC9B,CAAC;IAEM,6BAAM,GAAb;QACI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI;YAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAA;IACvD,CAAC;IACL,mBAAC;AAAD,CAlDA,AAkDC,IAAA","file":"","sourceRoot":"/","sourcesContent":["import {IState} from \"./IState\";\r\n\r\nexport default class StateMachine {\r\n    constructor() {\r\n    }\r\n\r\n    private mStateDic: Map<number, IState> = new Map<number, IState>();\r\n    private mCurState;\r\n\r\n    public get curState(): IState {\r\n        return this.mCurState;\r\n    }\r\n\r\n    public stop() {\r\n        if (this.curState != null) {\r\n            this.curState.onExit(null, null);\r\n            this.mCurState = null\r\n        }\r\n    }\r\n\r\n    public registerState(state: IState) {\r\n        if (state == null) return;\r\n        if (this.mStateDic.has(state.stateId)) return;\r\n        this.mStateDic.set(state.stateId, state)\r\n\r\n    }\r\n\r\n    public removeState(stateId: number) {\r\n        if (this.mStateDic.has(stateId)) this.mStateDic.delete(stateId);\r\n        if (this.curState != null && this.curState.stateId == stateId) {\r\n            this.mCurState.onExit(null);\r\n            this.mCurState = null\r\n        }\r\n\r\n    }\r\n\r\n    public switchState(stateId: number, param: any) {\r\n        if (this.curState != null && this.curState.stateId == stateId) return;\r\n        if (!this.mStateDic.has(stateId)) {\r\n            console.error(\"没有找对应的状态：stateid =\" + stateId);\r\n            return\r\n        }\r\n        let nextState = this.mStateDic.get(stateId);\r\n        if (this.curState != null)\r\n            this.curState.onExit(nextState, param);\r\n        nextState.onEnter(this.mCurState == null ? null : this.curState, param);\r\n        this.mCurState = nextState\r\n    }\r\n\r\n    public update() {\r\n        if (this.curState != null) this.curState.onUpdate()\r\n    }\r\n} "]}