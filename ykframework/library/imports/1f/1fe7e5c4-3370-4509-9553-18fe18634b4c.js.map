{"version":3,"sources":["assets\\YK\\core\\ui\\UIWind.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { UIConfig } from \"./UIConfig\"\r\nimport { Func } from \"../utils/Listener\";\r\nimport IUISource = fgui.IUISource;\r\nimport UIPackage = fgui.UIPackage;\r\n\r\nexport class LoadFGUIPack implements IUISource {\r\n    fileName: string;\r\n    loaded: boolean;\r\n    finish: Func = null;\r\n \r\n\r\n    constructor(packName) {\r\n        this.fileName = UIConfig.packRootUrl + \"/\" + packName;\r\n    }\r\n\r\n    load(callback: Function, thisObj: any): void {\r\n        this.finish = Func.create(callback, thisObj);\r\n        fgui.UIPackage.loadPackage(this.fileName, this.loadDone.bind(this));\r\n    }\r\n\r\n    loadDone() {\r\n        this.loaded = true;\r\n        if (this.finish != null) {\r\n            this.loaded = true;\r\n            this.finish.run();\r\n        }\r\n    }\r\n}\r\n\r\nexport class UIWind extends fgui.Window {\r\n\r\n    private static readonly mWinds = new Map<string, UIWind>();\r\n\r\n    public readonly packName: string;\r\n\r\n    public readonly resName: string;\r\n\r\n    protected readonly mCloseBtnName = \"BtnClose\";\r\n\r\n    constructor(packName, resName) {\r\n        super();\r\n        this.packName = packName;\r\n        this.resName = resName;\r\n        this.url = `ui://${packName}/${resName}`;\r\n\r\n        this.addUISource(new LoadFGUIPack(packName));\r\n    }\r\n\r\n    public static add(wind: UIWind) {\r\n        this.mWinds.set(wind.url, wind);\r\n    }\r\n\r\n    public static remove(wind: UIWind) {\r\n        if (this.mWinds.has(wind.url)) {\r\n            this.mWinds.delete(wind.url);\r\n            wind.dispose();\r\n        }\r\n    }\r\n\r\n    public static show(url: string, param?: any) {\r\n        if (this.mWinds.has(url)) {\r\n            let wind = this.mWinds.get(url);\r\n            wind.data = param;\r\n            if (wind.isShowing) {\r\n                wind.onShown();\r\n            } else {\r\n                wind.show();\r\n            }\r\n        } else {\r\n            console.error(\"显示窗口失败没有注册窗口 url:\" + url);\r\n        }\r\n    }\r\n\r\n    public static hide(url: string, param?: any) {\r\n        if (this.mWinds.has(url)) {\r\n            let wind = this.mWinds.get(url);\r\n            if (wind.isShowing) {\r\n                wind.data = param;\r\n                wind.hide();\r\n            }\r\n        } else {\r\n            console.error(\"隐藏窗口失败没有注册窗口 url:\" + url);\r\n        }\r\n    }\r\n\r\n    public static hideAll(filter: Array<string> = null) {\r\n        this.mWinds.forEach((v, k) => {\r\n            if (v.isShowing && (filter == null || filter.findIndex(a => a == v.url) == -1)) {\r\n                v.hide();\r\n            }\r\n        });\r\n    }\r\n\r\n    public static delAll(filter: Array<string> = null) {\r\n        let needDel = new Array<string>();\r\n        this.mWinds.forEach((v, k) => {\r\n            if (filter == null || filter.findIndex(a => a == v.url) == -1) {\r\n                needDel.push(v.url);\r\n            }\r\n        });\r\n\r\n        for (let i = 0; i < needDel.length; i++) {\r\n            this.remove(this.mWinds.get(needDel[i]));\r\n        }\r\n    }\r\n\r\n    protected onInit(): void {\r\n        console.log(\"显示成功\");\r\n        let windObj = UIPackage.createObjectFromURL(this.url);\r\n        if (windObj == null) {\r\n            console.error(\"创建窗口失败 url\" + this.url);\r\n            return;\r\n        }\r\n        this.contentPane = windObj.asCom;\r\n        this.width = fairygui.GRoot.inst.width;\r\n        this.height = fairygui.GRoot.inst.height;\r\n        this.centerOn(fgui.GRoot.inst, true);\r\n        if (this.mCloseBtnName != null && this.mCloseBtnName.length != 0) {\r\n            let btnClose = this.contentPane.getChild(this.mCloseBtnName);\r\n            if (btnClose && (btnClose.asCom || btnClose.asButton)) {\r\n                this.closeButton = btnClose;\r\n            }\r\n        }\r\n    }\r\n\r\n    public url: string;\r\n}\r\n\r\n"]}